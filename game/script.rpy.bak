# Defined characters.

define pv = Character("[violet_name]", color="#000000", who_outlines=[ (2, "#FFFFFF") ], what_outlines=[ (2, "#FFFFFF") ])
define pa = Character("[violet_name]", color="#000000", who_outlines=[ (2, "#FFFFFF") ], what_outlines=[ (2, "#FFFFFF") ])
define n = Character("Narrator", color="#000000", who_outlines=[ (2, "#FFFFFF") ], what_outlines=[ (2, "#FFFFFF") ])
define v = Character("Violet", color="#000000", who_outlines=[ (2, "#FFFFFF") ], what_outlines=[ (2, "#FFFFFF") ])
define a = Character("Amber", color="#000000", who_outlines=[ (2, "#FFFFFF") ], what_outlines=[ (2, "#FFFFFF") ])

# Start of a new game.

label start:
    
    # Variable settings.
    
    default gender = 0
    default dating = 1
    default violet = 1
    default amber = 1
    $ age = 18
    $ violet_name = ""
    $ violet_from = ""
    $ amber_name = ""
    $ amber_from = ""
    default window_crack = 0
    default vase = 0
    default v_wet = 0
    default tooltip = Tooltip("")

    # Show a blank background for the game setup.
    
    scene blank
    with dissolve
    
    stop music
    
    # Ask question to user if they are a boy or girl and what age they are.
    
    n "Before we start, are you a boy or a girl? How old are you?"
    menu:
        n "What you choose will affect the story path."
        "Boy":
            $ gender = 0
            python:
                try:
                    age = int(renpy.input("Enter the age you want your character to be."))
                except Exception:
                    age = 18
            if age <= 18:
                $ age = 18
            $ violet = 1
            $ amber = 1
            jump starting_path
        "Girl":
            $ gender = 1
            python:
                try:
                    age = int(renpy.input("Enter the age you want your character to be."))
                except Exception:
                    age = 18
            if age <= 18:
                $ age = 18
            $ violet = 1
            $ amber = 1
            jump starting_path
             
    # This is an error if a user sees under this line.

    "You shouldn't be seeing this..."

    return

label starting_path:

    $ renpy.block_rollback()
    
    scene car
    with dissolve
    
    play music "audio/car_music.flac" loop fadein 3.0
    
    play sound "audio/rain.flac" loop fadein 3.0
    
    pause 3.0
    
    if gender == 0:
        
        n "The rain splashes heavily in the puddles outside as if the heavens are crying, as you make your way to your destination."
    
        n "The car radio drones on a discordant rock tune."
    
        n "You feel a pit in your stomach as you've never been this far away from home before."
    
        n "You're moving to a small town because your parents are divorcing."

        n "You want to start making friends with the local girls, and maybe even get into their panties."
        
    elif gender == 1:
        
        n "The rain splashes heavily in the puddles outside as if the heavens are crying, as you make your way to your destination."
    
        n "The car radio drones on a discordant rock tune."
    
        n "You feel a pit in your stomach as you've never been this far away from home before."

        n "You're moving to a small town because your attending a university there."
    
        n "Recently, you came out as lesbian to your old friends, but you're afraid of what the animals in this new town will think."
    
    
    scene house
    with dissolve
    
    n "The car screeches to a halt. You have arrived at your new home..."
    
    play audio "audio/thunder.flac"
    
    n "You grab your bags and head inside. You look around and find a study with a desk and a pinboard. You decide to use this as your ''base of operations.''"
    
    stop music fadeout 3.0
    
    stop sound fadeout 3.0
    
    pause 3.0
    
    if gender == 0:
        scene hub_boy
    elif gender == 1:
        scene hub_girl
    with dissolve    
    jump main_hub_screen

return

# Gallery

label gallery:
    
    $ tooltip = Tooltip("")
    
    scene gallery
    with dissolve
    
    call screen gallery_items
    
    screen gallery_items:
    
        imagebutton auto "close_%s":
            xanchor 0.5
            yanchor 0.5
            xpos 0.95
            ypos 0.9
            hovered [ Play("sound", "audio/select.flac"), tooltip.Action("Return to the hub.") ]
            action Jump("main_hub_screen")
 
        if violet >= 2:
            imagebutton auto "gallery_violet_1_%s":
                xanchor 0.5
                yanchor 0.5
                xpos 0.1
                ypos 0.2
                hovered [ Play("sound", "audio/select.flac"), tooltip.Action("The picture Violet gave you on your first date.") ]
                action Jump("violet_p1")
        else:
            imagebutton auto "gallery_unknown_%s":
                xanchor 0.5
                yanchor 0.5
                xpos 0.1
                ypos 0.2
                hovered [ Play("sound", "audio/select.flac"), tooltip.Action("Unlock this picture by completing the corresponding date.") ]
                
        if violet >= 3:
            imagebutton auto "gallery_violet_2_%s":
                xanchor 0.5
                yanchor 0.5
                xpos 0.25
                ypos 0.2
                hovered [ Play("sound", "audio/select.flac"), tooltip.Action("The picture Violet gave you on your second date.") ]
                action Jump("violet_p2")
        else:
            imagebutton auto "gallery_unknown_%s":
                xanchor 0.5
                yanchor 0.5
                xpos 0.25
                ypos 0.2
                hovered [ Play("sound", "audio/select.flac"), tooltip.Action("Unlock this picture by completing the corresponding date.") ]
                
        if violet >= 4:
            imagebutton auto "gallery_violet_3_%s":
                xanchor 0.5
                yanchor 0.5
                xpos 0.4
                ypos 0.2
                hovered [ Play("sound", "audio/select.flac"), tooltip.Action("The picture Violet gave you in a letter before your third date.") ]
                action Jump("violet_p3")
        else:
            imagebutton auto "gallery_unknown_%s":
                xanchor 0.5
                yanchor 0.5
                xpos 0.4
                ypos 0.2
                hovered [ Play("sound", "audio/select.flac"), tooltip.Action("Unlock this picture by completing the corresponding date.") ]
            
        text tooltip.value:
            xpos 0.05
            ypos 0.9
        
    return
    
    label violet_p1:
    
    scene blank
    with dissolve
    
    call screen violet_p1
    
    screen violet_p1:
        
        imagebutton idle "violet_date_1_pic":
            xanchor 0.5
            yanchor 0.5
            xpos 0.5
            ypos 0.5
            action Jump("gallery")
    
    return
    
    return
    
    label violet_p2:
    
    scene blank
    with dissolve
    
    call screen violet_p2
    
    screen violet_p2:
        
        imagebutton idle "violet_date_2_pic":
            xanchor 0.5
            yanchor 0.5
            xpos 0.5
            ypos 0.5
            action Jump("gallery")
    
    return
    
    label violet_p3:
    
    scene blank
    with dissolve
    
    call screen violet_p3
    
    screen violet_p3:
        
        imagebutton idle "violet_date_3_pic":
            xanchor 0.5
            yanchor 0.5
            xpos 0.5
            ypos 0.5
            action Jump("gallery")
    
    return

return 

# Python crap (annoying shit).

init python:
    def drag_placed(drags, drop):
        if not drop:
            return

        store.draggable = drags[0].drag_name
        store.droppable = drop.drag_name
        
        return True